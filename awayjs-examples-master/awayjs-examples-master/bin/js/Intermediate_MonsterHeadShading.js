(function e(t,i,a){function s(n,o){if(!i[n]){if(!t[n]){var l=typeof require=="function"&&require;if(!o&&l)return l(n,!0);if(r)return r(n,!0);var h=new Error("Cannot find module '"+n+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[n]={exports:{}};t[n][0].call(d.exports,function(e){var i=t[n][1][e];return s(i?i:e)},d,d.exports,e,t,i,a)}return i[n].exports}var r=typeof require=="function"&&require;for(var n=0;n<a.length;n++)s(a[n]);return s})({"./src/Intermediate_MonsterHeadShading.ts":[function(e,t,i){var a=e("awayjs-core/lib/events/AssetEvent");var s=e("awayjs-core/lib/events/Event");var r=e("awayjs-core/lib/events/LoaderEvent");var n=e("awayjs-core/lib/events/ProgressEvent");var o=e("awayjs-core/lib/geom/Vector3D");var l=e("awayjs-core/lib/library/AssetLibrary");var h=e("awayjs-core/lib/library/AssetLoaderContext");var d=e("awayjs-core/lib/net/URLLoader");var u=e("awayjs-core/lib/net/URLLoaderDataFormat");var c=e("awayjs-core/lib/net/URLRequest");var _=e("awayjs-core/lib/parsers/ParserUtils");var p=e("awayjs-core/lib/textures/ImageTexture");var g=e("awayjs-core/lib/textures/SpecularBitmapTexture");var m=e("awayjs-core/lib/utils/RequestAnimationFrame");var w=e("awayjs-display/lib/containers/Scene");var y=e("awayjs-display/lib/containers/View");var f=e("awayjs-display/lib/controllers/HoverController");var v=e("awayjs-display/lib/entities/Camera");var M=e("awayjs-display/lib/entities/DirectionalLight");var b=e("awayjs-display/lib/entities/PointLight");var L=e("awayjs-display/lib/entities/Mesh");var j=e("awayjs-display/lib/materials/lightpickers/StaticLightPicker");var E=e("awayjs-display/lib/utils/Cast");var D=e("awayjs-renderergl/lib/DefaultRenderer");var C=e("awayjs-methodmaterials/lib/MethodMaterial");var R=e("awayjs-methodmaterials/lib/pool/MethodRendererPool");var x=e("awayjs-methodmaterials/lib/MethodMaterialMode");var S=e("awayjs-methodmaterials/lib/methods/SpecularFresnelMethod");var P=e("awayjs-methodmaterials/lib/methods/ShadowSoftMethod");var A=e("awayjs-parsers/lib/AWDParser");var T=function(){function e(){this._textureStrings=Array("monsterhead_diffuse.jpg","monsterhead_specular.jpg","monsterhead_normals.jpg");this._textureDictionary=new Object;this._advancedMethod=true;this._numTextures=0;this._currentTexture=0;this._n=0;this._assetsRoot="assets/monsterhead/";this._move=false;this.time=0;this._shadowRange=3;this._lightDirection=120*Math.PI/180;this._lightElevation=30*Math.PI/180;this.init()}e.prototype.init=function(){this.initEngine();this.initLights();this.initListeners();this._n=0;this._numTextures=this._textureStrings.length;this.load(this._textureStrings[this._n])};e.prototype.initEngine=function(){this._scene=new w;this._camera=new v;this._camera.projection.near=20;this._camera.projection.far=1e3;this._view=new y(new D(R),this._scene,this._camera);this._cameraController=new f(this._camera,null,225,10,800);this._cameraController.yFactor=1};e.prototype.initLights=function(){var e=Math.sin(this._lightElevation)*Math.cos(this._lightDirection);var t=-Math.cos(this._lightElevation);var i=Math.sin(this._lightElevation)*Math.sin(this._lightDirection);this._directionalLight=new M(e,t,i);this._directionalLight.color=16772829;this._directionalLight.ambient=1;this._directionalLight.specular=.3;this._directionalLight.ambientColor=1052709;this._directionalLight.castsShadows=true;this._directionalLight.shadowMapper.lightOffset=1e3;this._scene.addChild(this._directionalLight);this._blueLight=new b;this._blueLight.color=4227327;this._blueLight.x=3e3;this._blueLight.z=700;this._blueLight.y=20;this._scene.addChild(this._blueLight);this._redLight=new b;this._redLight.color=8396816;this._redLight.x=-2e3;this._redLight.z=800;this._redLight.y=-400;this._scene.addChild(this._redLight);this._lightPicker=new j([this._directionalLight,this._blueLight,this._redLight])};e.prototype.initListeners=function(){var e=this;window.onresize=function(t){return e.onResize(t)};document.onmousedown=function(t){return e.onMouseDown(t)};document.onmouseup=function(t){return e.onMouseUp(t)};document.onmousemove=function(t){return e.onMouseMove(t)};this.onResize();this.parseAWDDelegate=function(t){return e.parseAWD(t)};this.parseBitmapDelegate=function(t){return e.parseBitmap(t)};this.loadProgressDelegate=function(t){return e.loadProgress(t)};this.onBitmapCompleteDelegate=function(t){return e.onBitmapComplete(t)};this.onAssetCompleteDelegate=function(t){return e.onAssetComplete(t)};this.onResourceCompleteDelegate=function(t){return e.onResourceComplete(t)};this.timer=new m(this.onEnterFrame,this);this.timer.start()};e.prototype.updateDirection=function(){this._directionalLight.direction=new o(Math.sin(this._lightElevation)*Math.cos(this._lightDirection),-Math.cos(this._lightElevation),Math.sin(this._lightElevation)*Math.sin(this._lightDirection))};e.prototype.updateRange=function(){this._softShadowMethod.range=this._shadowRange};e.prototype.load=function(e){var t=new d;switch(e.substring(e.length-3)){case"AWD":case"awd":t.dataFormat=u.ARRAY_BUFFER;this._loadingText="Loading Model";t.addEventListener(s.COMPLETE,this.parseAWDDelegate);break;case"png":case"jpg":t.dataFormat=u.BLOB;this._currentTexture++;this._loadingText="Loading Textures";t.addEventListener(s.COMPLETE,this.parseBitmapDelegate);break}t.addEventListener(n.PROGRESS,this.loadProgressDelegate);t.load(new c(this._assetsRoot+e))};e.prototype.loadProgress=function(e){var t=Math.floor(e["bytesLoaded"]/e["bytesTotal"]*100);if(t!=100){console.log(this._loadingText+"\n"+(this._loadingText=="Loading Model"?Math.floor(e["bytesLoaded"]/1024<<0)+"kb | "+Math.floor(e["bytesTotal"]/1024<<0)+"kb":this._currentTexture+" | "+this._numTextures))}};e.prototype.parseBitmap=function(e){var t=e.target;var i=_.blobToImage(t.data);i.onload=this.onBitmapCompleteDelegate;t.removeEventListener(s.COMPLETE,this.parseBitmapDelegate);t.removeEventListener(n.PROGRESS,this.loadProgressDelegate);t=null};e.prototype.parseAWD=function(e){console.log("Parsing Data");var t=e.target;l.addEventListener(a.ASSET_COMPLETE,this.onAssetCompleteDelegate);l.addEventListener(r.RESOURCE_COMPLETE,this.onResourceCompleteDelegate);l.loadData(t.data,new h(false),null,new A);t.removeEventListener(n.PROGRESS,this.loadProgressDelegate);t.removeEventListener(s.COMPLETE,this.parseAWDDelegate);t=null};e.prototype.onBitmapComplete=function(e){var t=e.target;t.onload=null;if(!this._textureDictionary[this._textureStrings[this._n]])this._textureDictionary[this._textureStrings[this._n]]=this._n==1?new g(E.bitmapData(t)):new p(t);this._n++;if(this._n<this._textureStrings.length){this.load(this._textureStrings[this._n])}else{this.load("MonsterHead.awd")}};e.prototype.onEnterFrame=function(e){this._view.render()};e.prototype.onAssetComplete=function(e){if(e.asset.isAsset(L)){this._headModel=e.asset;this._headModel.geometry.scale(4);this._headModel.y=-20;this._scene.addChild(this._headModel)}};e.prototype.onResourceComplete=function(e){var t=this;l.removeEventListener(a.ASSET_COMPLETE,this.onAssetCompleteDelegate);l.removeEventListener(r.RESOURCE_COMPLETE,this.onResourceCompleteDelegate);this._headMaterial=new C(this._textureDictionary["monsterhead_diffuse.jpg"]);this._headMaterial.mode=x.MULTI_PASS;this._headMaterial.mipmap=false;this._headMaterial.normalMap=this._textureDictionary["monsterhead_normals.jpg"];this._headMaterial.lightPicker=this._lightPicker;this._headMaterial.ambientColor=3158080;this._softShadowMethod=new P(this._directionalLight,20);this._softShadowMethod.range=this._shadowRange;this._softShadowMethod.epsilon=.1;this._headMaterial.shadowMethod=this._softShadowMethod;this._fresnelMethod=new S(true);this._fresnelMethod.fresnelPower=3;this._headMaterial.specularMethod=this._fresnelMethod;this._headMaterial.specularMap=this._textureDictionary["monsterhead_specular.jpg"];this._headMaterial.specular=3;this._headMaterial.gloss=10;var i=this._headModel.subMeshes.length;for(var s=0;s<i;s++)this._headModel.subMeshes[s].material=this._headMaterial;l.addEventListener(r.RESOURCE_COMPLETE,function(e){return t.onExtraResourceComplete(e)});l.load(new c("assets/diffuseGradient.jpg"))};e.prototype.onExtraResourceComplete=function(e){switch(e.url){case"assets/diffuseGradient.jpg":break}};e.prototype.onMouseDown=function(e){this._lastPanAngle=this._cameraController.panAngle;this._lastTiltAngle=this._cameraController.tiltAngle;this._lastMouseX=e.clientX;this._lastMouseY=e.clientY;this._move=true};e.prototype.onMouseUp=function(e){this._move=false};e.prototype.onMouseMove=function(e){if(this._move){this._cameraController.panAngle=.3*(e.clientX-this._lastMouseX)+this._lastPanAngle;this._cameraController.tiltAngle=.3*(e.clientY-this._lastMouseY)+this._lastTiltAngle}};e.prototype.onResize=function(e){if(e===void 0){e=null}this._view.y=0;this._view.x=0;this._view.width=window.innerWidth;this._view.height=window.innerHeight};return e}();window.onload=function(){new T}},{"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/LoaderEvent":undefined,"awayjs-core/lib/events/ProgressEvent":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/library/AssetLibrary":undefined,"awayjs-core/lib/library/AssetLoaderContext":undefined,"awayjs-core/lib/net/URLLoader":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-core/lib/textures/ImageTexture":undefined,"awayjs-core/lib/textures/SpecularBitmapTexture":undefined,"awayjs-core/lib/utils/RequestAnimationFrame":undefined,"awayjs-display/lib/containers/Scene":undefined,"awayjs-display/lib/containers/View":undefined,"awayjs-display/lib/controllers/HoverController":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-display/lib/entities/DirectionalLight":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-display/lib/materials/lightpickers/StaticLightPicker":undefined,"awayjs-display/lib/utils/Cast":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined,"awayjs-methodmaterials/lib/methods/ShadowSoftMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularFresnelMethod":undefined,"awayjs-methodmaterials/lib/pool/MethodRendererPool":undefined,"awayjs-parsers/lib/AWDParser":undefined,"awayjs-renderergl/lib/DefaultRenderer":undefined}]},{},["./src/Intermediate_MonsterHeadShading.ts"]);

//# sourceMappingURL=Intermediate_MonsterHeadShading.js.map