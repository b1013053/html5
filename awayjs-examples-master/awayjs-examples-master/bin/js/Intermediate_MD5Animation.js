(function e(t,i,s){function a(r,o){if(!i[r]){if(!t[r]){var h=typeof require=="function"&&require;if(!o&&h)return h(r,!0);if(n)return n(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var d=i[r]={exports:{}};t[r][0].call(d.exports,function(e){var i=t[r][1][e];return a(i?i:e)},d,d.exports,e,t,i,s)}return i[r].exports}var n=typeof require=="function"&&require;for(var r=0;r<s.length;r++)a(s[r]);return a})({"./src/Intermediate_MD5Animation.ts":[function(e,t,i){var s=e("awayjs-core/lib/events/AssetEvent");var a=e("awayjs-core/lib/events/LoaderEvent");var n=e("awayjs-core/lib/geom/UVTransform");var r=e("awayjs-core/lib/library/AssetLibrary");var o=e("awayjs-core/lib/library/AssetLoaderContext");var h=e("awayjs-core/lib/net/URLRequest");var l=e("awayjs-core/lib/ui/Keyboard");var d=e("awayjs-core/lib/utils/RequestAnimationFrame");var c=e("awayjs-display/lib/animators/nodes/AnimationNodeBase");var u=e("awayjs-display/lib/containers/DisplayObjectContainer");var b=e("awayjs-display/lib/containers/View");var m=e("awayjs-display/lib/controllers/LookAtController");var p=e("awayjs-display/lib/entities/DirectionalLight");var g=e("awayjs-display/lib/entities/Billboard");var y=e("awayjs-display/lib/entities/Mesh");var w=e("awayjs-display/lib/entities/PointLight");var M=e("awayjs-display/lib/entities/Skybox");var f=e("awayjs-display/lib/materials/shadowmappers/NearDirectionalShadowMapper");var E=e("awayjs-display/lib/materials/lightpickers/StaticLightPicker");var v=e("awayjs-display/lib/prefabs/PrimitivePlanePrefab");var k=e("awayjs-renderergl/lib/animators/AnimationSetBase");var A=e("awayjs-renderergl/lib/animators/SkeletonAnimator");var L=e("awayjs-renderergl/lib/animators/data/Skeleton");var j=e("awayjs-renderergl/lib/animators/transitions/CrossfadeTransition");var _=e("awayjs-renderergl/lib/events/AnimationStateEvent");var S=e("awayjs-renderergl/lib/DefaultRenderer");var D=e("awayjs-methodmaterials/lib/MethodMaterial");var N=e("awayjs-methodmaterials/lib/pool/MethodRendererPool");var P=e("awayjs-methodmaterials/lib/methods/EffectFogMethod");var R=e("awayjs-methodmaterials/lib/methods/ShadowNearMethod");var C=e("awayjs-methodmaterials/lib/methods/ShadowSoftMethod");var T=e("awayjs-parsers/lib/MD5AnimParser");var I=e("awayjs-parsers/lib/MD5MeshParser");var x=function(){function e(){this.stateTransition=new j(.5);this.currentRotationInc=0;this.count=0;this._time=0;this.init()}e.prototype.init=function(){this.initEngine();this.initLights();this.initMaterials();this.initObjects();this.initListeners()};e.prototype.initEngine=function(){this.view=new b(new S(N));this.scene=this.view.scene;this.camera=this.view.camera;this.camera.projection.far=5e3;this.camera.z=-200;this.camera.y=160;this.placeHolder=new u;this.placeHolder.y=50;this.cameraController=new m(this.camera,this.placeHolder)};e.prototype.initLights=function(){this.redLight=new w;this.redLight.x=-1e3;this.redLight.y=200;this.redLight.z=-1400;this.redLight.color=16716049;this.scene.addChild(this.redLight);this.blueLight=new w;this.blueLight.x=1e3;this.blueLight.y=200;this.blueLight.z=1400;this.blueLight.color=1118719;this.scene.addChild(this.blueLight);this.whiteLight=new p(-50,-20,10);this.whiteLight.color=16777198;this.whiteLight.castsShadows=true;this.whiteLight.ambient=1;this.whiteLight.ambientColor=3158080;this.whiteLight.shadowMapper=new f(.2);this.scene.addChild(this.whiteLight);this.lightPicker=new E([this.redLight,this.blueLight,this.whiteLight]);this.shadowMapMethod=new R(new C(this.whiteLight,15,8));this.shadowMapMethod.epsilon=.1;this.fogMethod=new P(0,this.camera.projection.far*.5,0)};e.prototype.initMaterials=function(){this.redLightMaterial=new D;this.redLightMaterial.alphaBlending=true;this.redLightMaterial.addEffectMethod(this.fogMethod);this.blueLightMaterial=new D;this.blueLightMaterial.alphaBlending=true;this.blueLightMaterial.addEffectMethod(this.fogMethod);this.groundMaterial=new D;this.groundMaterial.smooth=true;this.groundMaterial.repeat=true;this.groundMaterial.lightPicker=this.lightPicker;this.groundMaterial.shadowMethod=this.shadowMapMethod;this.groundMaterial.addEffectMethod(this.fogMethod);this.bodyMaterial=new D;this.bodyMaterial.gloss=20;this.bodyMaterial.specular=1.5;this.bodyMaterial.addEffectMethod(this.fogMethod);this.bodyMaterial.lightPicker=this.lightPicker;this.bodyMaterial.shadowMethod=this.shadowMapMethod;this.gobMaterial=new D;this.gobMaterial.alphaBlending=true;this.gobMaterial.smooth=true;this.gobMaterial.repeat=true;this.gobMaterial.animateUVs=true;this.gobMaterial.addEffectMethod(this.fogMethod);this.gobMaterial.lightPicker=this.lightPicker;this.gobMaterial.shadowMethod=this.shadowMapMethod};e.prototype.initObjects=function(){var e=new g(this.redLightMaterial);e.width=200;e.height=200;e.castsShadows=false;var t=new g(this.blueLightMaterial);t.width=200;t.height=200;t.castsShadows=false;this.redLight.addChild(e);this.blueLight.addChild(t);r.enableParser(I);r.enableParser(T);this.ground=new v(5e4,5e4,1,1).getNewObject();this.ground.material=this.groundMaterial;this.ground.geometry.scaleUV(200,200);this.ground.castsShadows=false;this.scene.addChild(this.ground)};e.prototype.initListeners=function(){var e=this;window.onresize=function(t){return e.onResize(t)};document.onkeydown=function(t){return e.onKeyDown(t)};document.onkeyup=function(t){return e.onKeyUp(t)};this.onResize();this._timer=new d(this.onEnterFrame,this);this._timer.start();var t=new o;t.dependencyBaseUrl="assets/skybox/";r.addEventListener(s.ASSET_COMPLETE,function(t){return e.onAssetComplete(t)});r.addEventListener(a.RESOURCE_COMPLETE,function(t){return e.onResourceComplete(t)});r.load(new h("assets/hellknight/hellknight.md5mesh"),null,null,new I);r.load(new h("assets/skybox/grimnight_texture.cube"),t);r.load(new h("assets/redlight.png"));r.load(new h("assets/bluelight.png"));r.load(new h("assets/rockbase_diffuse.jpg"));r.load(new h("assets/rockbase_normals.png"));r.load(new h("assets/rockbase_specular.png"));r.load(new h("assets/hellknight/hellknight_diffuse.jpg"));r.load(new h("assets/hellknight/hellknight_normals.png"));r.load(new h("assets/hellknight/hellknight_specular.png"));r.load(new h("assets/hellknight/gob.png"))};e.prototype.onEnterFrame=function(e){this._time+=e;this.cameraController.update();if(this.mesh){this.mesh.subMeshes[1].uvTransform.offsetV=this.mesh.subMeshes[2].uvTransform.offsetV=this.mesh.subMeshes[3].uvTransform.offsetV=-this._time/2e3%1;this.mesh.rotationY+=this.currentRotationInc}this.count+=.01;this.redLight.x=Math.sin(this.count)*1500;this.redLight.y=250+Math.sin(this.count*.54)*200;this.redLight.z=Math.cos(this.count*.7)*1500;this.blueLight.x=-Math.sin(this.count*.8)*1500;this.blueLight.y=250-Math.sin(this.count*.65)*200;this.blueLight.z=-Math.cos(this.count*.9)*1500;this.view.render()};e.prototype.onAssetComplete=function(t){var i=this;if(t.asset.isAsset(c)){var s=t.asset;var a=t.asset.assetNamespace;s.name=a;this.animationSet.addAnimation(s);if(a==e.IDLE_NAME||a==e.WALK_NAME){s.looping=true}else{s.looping=false;s.addEventListener(_.PLAYBACK_COMPLETE,function(e){return i.onPlaybackComplete(e)})}if(a==e.IDLE_NAME)this.stop()}else if(t.asset.isAsset(k)){this.animationSet=t.asset;this.animator=new A(this.animationSet,this.skeleton);for(var o=0;o<e.ANIM_NAMES.length;++o)r.load(new h("assets/hellknight/"+e.ANIM_NAMES[o]+".md5anim"),null,e.ANIM_NAMES[o],new T);this.mesh.animator=this.animator}else if(t.asset.isAsset(L)){this.skeleton=t.asset}else if(t.asset.isAsset(y)){this.mesh=t.asset;this.mesh.subMeshes[0].material=this.bodyMaterial;this.mesh.subMeshes[1].material=this.mesh.subMeshes[2].material=this.mesh.subMeshes[3].material=this.gobMaterial;this.mesh.castsShadows=true;this.mesh.rotationY=180;this.mesh.subMeshes[1].uvTransform=this.mesh.subMeshes[2].uvTransform=this.mesh.subMeshes[3].uvTransform=new n;this.scene.addChild(this.mesh);this.mesh.addChild(this.placeHolder)}};e.prototype.onResourceComplete=function(e){switch(e.url){case"assets/skybox/grimnight_texture.cube":this.cubeTexture=e.assets[0];this.skyBox=new M(this.cubeTexture);this.scene.addChild(this.skyBox);break;case"assets/redlight.png":this.redLightMaterial.texture=e.assets[0];break;case"assets/bluelight.png":this.blueLightMaterial.texture=e.assets[0];break;case"assets/rockbase_diffuse.jpg":this.groundMaterial.texture=e.assets[0];break;case"assets/rockbase_normals.png":this.groundMaterial.normalMap=e.assets[0];break;case"assets/rockbase_specular.png":this.groundMaterial.specularMap=e.assets[0];break;case"assets/hellknight/hellknight_diffuse.jpg":this.bodyMaterial.texture=e.assets[0];break;case"assets/hellknight/hellknight_normals.png":this.bodyMaterial.normalMap=e.assets[0];break;case"assets/hellknight/hellknight_specular.png":this.bodyMaterial.specularMap=e.assets[0];break;case"assets/hellknight/gob.png":this.bodyMaterial.specularMap=this.gobMaterial.texture=e.assets[0];break}};e.prototype.onPlaybackComplete=function(t){if(this.animator.activeState!=t.animationState)return;this.onceAnim=null;this.animator.play(this.currentAnim,this.stateTransition);this.animator.playbackSpeed=this.isMoving?this.movementDirection*(this.isRunning?e.RUN_SPEED:e.WALK_SPEED):e.IDLE_SPEED};e.prototype.playAction=function(t){this.onceAnim=e.ANIM_NAMES[t+2];this.animator.playbackSpeed=e.ACTION_SPEED;this.animator.play(this.onceAnim,this.stateTransition,0)};e.prototype.onKeyDown=function(t){switch(t.keyCode){case l.SHIFT:this.isRunning=true;if(this.isMoving)this.updateMovement(this.movementDirection);break;case l.UP:case l.W:case l.Z:this.updateMovement(this.movementDirection=1);break;case l.DOWN:case l.S:this.updateMovement(this.movementDirection=-1);break;case l.LEFT:case l.A:case l.Q:this.currentRotationInc=-e.ROTATION_SPEED;break;case l.RIGHT:case l.D:this.currentRotationInc=e.ROTATION_SPEED;break}};e.prototype.onKeyUp=function(e){switch(e.keyCode){case l.SHIFT:this.isRunning=false;if(this.isMoving)this.updateMovement(this.movementDirection);break;case l.UP:case l.W:case l.Z:case l.DOWN:case l.S:this.stop();break;case l.LEFT:case l.A:case l.Q:case l.RIGHT:case l.D:this.currentRotationInc=0;break;case l.NUMBER_1:this.playAction(1);break;case l.NUMBER_2:this.playAction(2);break;case l.NUMBER_3:this.playAction(3);break;case l.NUMBER_4:this.playAction(4);break;case l.NUMBER_5:this.playAction(5);break;case l.NUMBER_6:this.playAction(6);break;case l.NUMBER_7:this.playAction(7);break;case l.NUMBER_8:this.playAction(8);break;case l.NUMBER_9:this.playAction(9);break}};e.prototype.updateMovement=function(t){this.isMoving=true;this.animator.playbackSpeed=t*(this.isRunning?e.RUN_SPEED:e.WALK_SPEED);if(this.currentAnim==e.WALK_NAME)return;this.currentAnim=e.WALK_NAME;if(this.onceAnim)return;this.animator.play(this.currentAnim,this.stateTransition)};e.prototype.stop=function(){this.isMoving=false;if(this.currentAnim==e.IDLE_NAME)return;this.currentAnim=e.IDLE_NAME;if(this.onceAnim)return;this.animator.playbackSpeed=e.IDLE_SPEED;this.animator.play(this.currentAnim,this.stateTransition)};e.prototype.onResize=function(e){if(e===void 0){e=null}this.view.width=window.innerWidth;this.view.height=window.innerHeight};e.IDLE_NAME="idle2";e.WALK_NAME="walk7";e.ANIM_NAMES=new Array(e.IDLE_NAME,e.WALK_NAME,"attack3","turret_attack","attack2","chest","roar1","leftslash","headpain","pain1","pain_luparm","range_attack2");e.ROTATION_SPEED=3;e.RUN_SPEED=2;e.WALK_SPEED=1;e.IDLE_SPEED=1;e.ACTION_SPEED=1;return e}();window.onload=function(){new x}},{"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/LoaderEvent":undefined,"awayjs-core/lib/geom/UVTransform":undefined,"awayjs-core/lib/library/AssetLibrary":undefined,"awayjs-core/lib/library/AssetLoaderContext":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/ui/Keyboard":undefined,"awayjs-core/lib/utils/RequestAnimationFrame":undefined,"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/containers/View":undefined,"awayjs-display/lib/controllers/LookAtController":undefined,"awayjs-display/lib/entities/Billboard":undefined,"awayjs-display/lib/entities/DirectionalLight":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-display/lib/entities/Skybox":undefined,"awayjs-display/lib/materials/lightpickers/StaticLightPicker":undefined,"awayjs-display/lib/materials/shadowmappers/NearDirectionalShadowMapper":undefined,"awayjs-display/lib/prefabs/PrimitivePlanePrefab":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/methods/EffectFogMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowNearMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowSoftMethod":undefined,"awayjs-methodmaterials/lib/pool/MethodRendererPool":undefined,"awayjs-parsers/lib/MD5AnimParser":undefined,"awayjs-parsers/lib/MD5MeshParser":undefined,"awayjs-renderergl/lib/DefaultRenderer":undefined,"awayjs-renderergl/lib/animators/AnimationSetBase":undefined,"awayjs-renderergl/lib/animators/SkeletonAnimator":undefined,"awayjs-renderergl/lib/animators/data/Skeleton":undefined,"awayjs-renderergl/lib/animators/transitions/CrossfadeTransition":undefined,"awayjs-renderergl/lib/events/AnimationStateEvent":undefined}]},{},["./src/Intermediate_MD5Animation.ts"]);

//# sourceMappingURL=Intermediate_MD5Animation.js.map