(function e(i,t,s){function a(n,o){if(!t[n]){if(!i[n]){var l=typeof require=="function"&&require;if(!o&&l)return l(n,!0);if(r)return r(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var h=t[n]={exports:{}};i[n][0].call(h.exports,function(e){var t=i[n][1][e];return a(t?t:e)},h,h.exports,e,i,t,s)}return t[n].exports}var r=typeof require=="function"&&require;for(var n=0;n<s.length;n++)a(s[n]);return a})({"./src/Intermediate_MouseInteraction.ts":[function(e,i,t){var s=e("awayjs-core/lib/data/BitmapData");var a=e("awayjs-core/lib/events/AssetEvent");var r=e("awayjs-core/lib/geom/Vector3D");var n=e("awayjs-core/lib/library/AssetLibrary");var o=e("awayjs-core/lib/net/URLRequest");var l=e("awayjs-core/lib/textures/BitmapTexture");var c=e("awayjs-core/lib/utils/RequestAnimationFrame");var h=e("awayjs-core/lib/ui/Keyboard");var d=e("awayjs-display/lib/containers/View");var u=e("awayjs-display/lib/controllers/HoverController");var p=e("awayjs-display/lib/bounds/BoundsType");var _=e("awayjs-display/lib/entities/LineSegment");var f=e("awayjs-display/lib/entities/Mesh");var b=e("awayjs-display/lib/entities/PointLight");var m=e("awayjs-display/lib/events/MouseEvent");var y=e("awayjs-display/lib/materials/BasicMaterial");var w=e("awayjs-display/lib/materials/lightpickers/StaticLightPicker");var v=e("awayjs-display/lib/pick/RaycastPicker");var M=e("awayjs-display/lib/prefabs/PrimitiveCubePrefab");var P=e("awayjs-display/lib/prefabs/PrimitiveCylinderPrefab");var g=e("awayjs-display/lib/prefabs/PrimitiveSpherePrefab");var j=e("awayjs-display/lib/prefabs/PrimitiveTorusPrefab");var k=e("awayjs-renderergl/lib/DefaultRenderer");var T=e("awayjs-renderergl/lib/pick/JSPickingCollider");var E=e("awayjs-methodmaterials/lib/MethodMaterial");var C=e("awayjs-methodmaterials/lib/pool/MethodRendererPool");var O=e("awayjs-parsers/lib/OBJParser");var N=function(){function e(){this._time=0;this._raycastPicker=new v(false);this._move=false;this._tiltSpeed=4;this._panSpeed=4;this._distanceSpeed=4;this._tiltIncrement=0;this._panIncrement=0;this._distanceIncrement=0;this.init()}e.prototype.init=function(){this.initEngine();this.initLights();this.initMaterials();this.initObjects();this.initListeners()};e.prototype.initEngine=function(){this._renderer=new k(C);this._view=new d(this._renderer);this._view.forceMouseMove=true;this._scene=this._view.scene;this._camera=this._view.camera;this._view.mousePicker=new v(true);this._cameraController=new u(this._camera,null,180,20,320,5)};e.prototype.initLights=function(){this._pointLight=new b;this._scene.addChild(this._pointLight);this._lightPicker=new w([this._pointLight])};e.prototype.initMaterials=function(){this._whiteMaterial=new E(16777215);this._whiteMaterial.lightPicker=this._lightPicker;this._blackMaterial=new E(3355443);this._blackMaterial.lightPicker=this._lightPicker;this._grayMaterial=new E(13421772);this._grayMaterial.lightPicker=this._lightPicker;this._blueMaterial=new E(255);this._blueMaterial.lightPicker=this._lightPicker;this._redMaterial=new E(16711680);this._redMaterial.lightPicker=this._lightPicker};e.prototype.initObjects=function(){var e=this;this._pickingPositionTracer=new g(2).getNewObject();this._pickingPositionTracer.material=new E(65280,.5);this._pickingPositionTracer.visible=false;this._pickingPositionTracer.mouseEnabled=false;this._pickingPositionTracer.mouseChildren=false;this._scene.addChild(this._pickingPositionTracer);this._scenePositionTracer=new g(2).getNewObject();this._pickingPositionTracer.material=new E(255,.5);this._scenePositionTracer.visible=false;this._scenePositionTracer.mouseEnabled=false;this._scene.addChild(this._scenePositionTracer);this._pickingNormalTracer=new _(new y(16777215),new r,new r,3);this._pickingNormalTracer.mouseEnabled=false;this._pickingNormalTracer.visible=false;this._view.scene.addChild(this._pickingNormalTracer);this._sceneNormalTracer=new _(new y(16777215),new r,new r,3);this._sceneNormalTracer.mouseEnabled=false;this._sceneNormalTracer.visible=false;this._view.scene.addChild(this._sceneNormalTracer);this._token=n.load(new o("assets/head.obj"),null,null,new O(25));this._token.addEventListener(a.ASSET_COMPLETE,function(i){return e.onAssetComplete(i)});this.createABunchOfObjects();this._raycastPicker.setIgnoreList([this._sceneNormalTracer,this._scenePositionTracer]);this._raycastPicker.onlyMouseEnabled=false};e.prototype.onAssetComplete=function(e){if(e.asset.isAsset(f)){this.initializeHeadModel(e.asset)}};e.prototype.initializeHeadModel=function(i){this._head=i;var t=new s(e.PAINT_TEXTURE_SIZE,e.PAINT_TEXTURE_SIZE,false,13421772);var a=new l(t);var r=new E(a);r.lightPicker=this._lightPicker;i.material=r;i.pickingCollider=new T(this._renderer.stage);i.mouseEnabled=i.mouseChildren=true;this.enableMeshMouseListeners(i);this._view.scene.addChild(i)};e.prototype.createABunchOfObjects=function(){this._cubePrefab=new M(25,50,25);this._spherePrefab=new g(12);this._cylinderPrefab=new P(12,12,25);this._torusPrefab=new j(12,12);for(var e=0;e<40;e++){var i=this.createSimpleObject();i.rotationZ=360*Math.random();var t=200+100*Math.random();var s=2*Math.PI*Math.random();var a=.25*Math.PI*Math.random();i.x=t*Math.cos(a)*Math.sin(s);i.y=t*Math.sin(a);i.z=t*Math.cos(a)*Math.cos(s)}};e.prototype.createSimpleObject=function(){var e;var i;var t=Math.random();if(t>.75){e=this._cubePrefab.getNewObject()}else if(t>.5){e=this._spherePrefab.getNewObject();i=p.SPHERE}else if(t>.25){e=this._cylinderPrefab.getNewObject()}else{e=this._torusPrefab.getNewObject()}if(i)e.boundsType=i;var s=Math.random()>.5;if(s){e.pickingCollider=new T(this._renderer.stage)}var a=Math.random()>.25;e.mouseEnabled=e.mouseChildren=a;var r=Math.random()>.25;if(a&&r){this.enableMeshMouseListeners(e)}this.choseMeshMaterial(e);this._view.scene.addChild(e);return e};e.prototype.choseMeshMaterial=function(e){if(!e.mouseEnabled){e.material=this._blackMaterial}else{if(!e.hasEventListener(m.MOUSE_MOVE)){e.material=this._grayMaterial}else{if(e.pickingCollider!=null){e.material=this._redMaterial}else{e.material=this._blueMaterial}}}};e.prototype.initListeners=function(){var e=this;window.onresize=function(i){return e.onResize(i)};document.onmousedown=function(i){return e.onMouseDown(i)};document.onmouseup=function(i){return e.onMouseUp(i)};document.onmousemove=function(i){return e.onMouseMove(i)};document.onmousewheel=function(i){return e.onMouseWheel(i)};document.onkeydown=function(i){return e.onKeyDown(i)};document.onkeyup=function(i){return e.onKeyUp(i)};this.onResize();this._timer=new c(this.onEnterFrame,this);this._timer.start()};e.prototype.onEnterFrame=function(e){this._pointLight.transform.position=this._camera.transform.position;var i=this._raycastPicker.getSceneCollision(this._camera.transform.position,this._view.camera.transform.forwardVector,this._view.scene);if(this._previoiusCollidingObject&&this._previoiusCollidingObject!=i){this._scenePositionTracer.visible=this._sceneNormalTracer.visible=false;this._scenePositionTracer.transform.position=new r}if(i){this._scenePositionTracer.visible=this._sceneNormalTracer.visible=true;this._scenePositionTracer.transform.position=i.displayObject.sceneTransform.transformVector(i.localPosition);this._sceneNormalTracer.transform.position=this._scenePositionTracer.transform.position;var t=i.displayObject.sceneTransform.deltaTransformVector(i.localNormal);t.normalize();t.scaleBy(25);this._sceneNormalTracer.endPosition=t.clone()}this._previoiusCollidingObject=i;this._view.render()};e.prototype.onKeyDown=function(e){switch(e.keyCode){case h.UP:case h.W:this._tiltIncrement=this._tiltSpeed;break;case h.DOWN:case h.S:this._tiltIncrement=-this._tiltSpeed;break;case h.LEFT:case h.A:this._panIncrement=this._panSpeed;break;case h.RIGHT:case h.D:this._panIncrement=-this._panSpeed;break;case h.Z:this._distanceIncrement=this._distanceSpeed;break;case h.X:this._distanceIncrement=-this._distanceSpeed;break}};e.prototype.onKeyUp=function(e){switch(e.keyCode){case h.UP:case h.W:case h.DOWN:case h.S:this._tiltIncrement=0;break;case h.LEFT:case h.A:case h.RIGHT:case h.D:this._panIncrement=0;break;case h.Z:case h.X:this._distanceIncrement=0;break}};e.prototype.enableMeshMouseListeners=function(e){var i=this;e.addEventListener(m.MOUSE_OVER,function(e){return i.onMeshMouseOver(e)});e.addEventListener(m.MOUSE_OUT,function(e){return i.onMeshMouseOut(e)});e.addEventListener(m.MOUSE_MOVE,function(e){return i.onMeshMouseMove(e)});e.addEventListener(m.MOUSE_DOWN,function(e){return i.onMeshMouseDown(e)})};e.prototype.onMeshMouseDown=function(e){};e.prototype.onMeshMouseOver=function(e){var i=e.object;i.debugVisible=true;if(i!=this._head)i.material=this._whiteMaterial;this._pickingPositionTracer.visible=this._pickingNormalTracer.visible=true;this.onMeshMouseMove(e)};e.prototype.onMeshMouseOut=function(e){var i=e.object;i.debugVisible=false;if(i!=this._head)this.choseMeshMaterial(i);this._pickingPositionTracer.visible=this._pickingNormalTracer.visible=false;this._pickingPositionTracer.transform.position=new r};e.prototype.onMeshMouseMove=function(e){this._pickingPositionTracer.visible=this._pickingNormalTracer.visible=true;this._pickingPositionTracer.transform.position=e.scenePosition;this._pickingNormalTracer.transform.position=this._pickingPositionTracer.transform.position;var i=e.sceneNormal.clone();i.scaleBy(25);this._pickingNormalTracer.endPosition=i.clone()};e.prototype.onMouseDown=function(e){this._lastPanAngle=this._cameraController.panAngle;this._lastTiltAngle=this._cameraController.tiltAngle;this._lastMouseX=e.clientX;this._lastMouseY=e.clientY;this._move=true};e.prototype.onMouseUp=function(e){this._move=false};e.prototype.onMouseMove=function(e){if(this._move){this._cameraController.panAngle=.3*(e.clientX-this._lastMouseX)+this._lastPanAngle;this._cameraController.tiltAngle=.3*(e.clientY-this._lastMouseY)+this._lastTiltAngle}};e.prototype.onMouseWheel=function(e){this._cameraController.distance-=e.wheelDelta;if(this._cameraController.distance<100)this._cameraController.distance=100;else if(this._cameraController.distance>2e3)this._cameraController.distance=2e3};e.prototype.onResize=function(e){if(e===void 0){e=null}this._view.y=0;this._view.x=0;this._view.width=window.innerWidth;this._view.height=window.innerHeight};e.PAINT_TEXTURE_SIZE=1024;return e}();window.onload=function(){new N}},{"awayjs-core/lib/data/BitmapData":undefined,"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/library/AssetLibrary":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/textures/BitmapTexture":undefined,"awayjs-core/lib/ui/Keyboard":undefined,"awayjs-core/lib/utils/RequestAnimationFrame":undefined,"awayjs-display/lib/bounds/BoundsType":undefined,"awayjs-display/lib/containers/View":undefined,"awayjs-display/lib/controllers/HoverController":undefined,"awayjs-display/lib/entities/LineSegment":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-display/lib/events/MouseEvent":undefined,"awayjs-display/lib/materials/BasicMaterial":undefined,"awayjs-display/lib/materials/lightpickers/StaticLightPicker":undefined,"awayjs-display/lib/pick/RaycastPicker":undefined,"awayjs-display/lib/prefabs/PrimitiveCubePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveSpherePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveTorusPrefab":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/pool/MethodRendererPool":undefined,"awayjs-parsers/lib/OBJParser":undefined,"awayjs-renderergl/lib/DefaultRenderer":undefined,"awayjs-renderergl/lib/pick/JSPickingCollider":undefined}]},{},["./src/Intermediate_MouseInteraction.ts"]);

//# sourceMappingURL=Intermediate_MouseInteraction.js.map